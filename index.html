<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Minimal Test</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
    }
    /* A simple container for everything */
    #home-page, #gallery-page {
      width: 100%;
      height: 100vh;
      display: none;
    }
    #home-page.active { display: block; }
    #gallery-page.active { display: block; }

    button {
      padding: 12px 18px;
      font-size: 16px;
      cursor: pointer;
    }
    #my-audio {
      display: block;
    }
    /* The bar at bottom for media controls */
    #media-control-hub {
      position: fixed;
      bottom: 0; left: 0; width: 100%;
      background: #000; color: #fff;
      display: flex; gap: 20px; padding: 12px;
      justify-content: flex-start;
      align-items: center;
      box-sizing: border-box;
    }
    #settings-section {
      margin-left: auto;
      position: relative;
    }
    #settings-btn {
      background: transparent; 
      color: #fff; 
      border: 1px solid #fff;
      font-size: 18px;
    }
    #settings-dropdown {
      display: none;
      position: absolute;
      bottom: 100%; /* open upward */
      right: 0;
      margin-bottom: 10px;
      background: #fff; color: #000;
      padding: 10px; border: 1px solid #000;
      z-index: 9999;
    }
    #settings-dropdown button {
      background: none; border: none; cursor: pointer;
      display: block; width: 100%;
      text-align: left; padding: 5px 0;
    }
  </style>
</head>
<body>
  <!-- HOME PAGE -->
  <div id="home-page" class="active">
    <h1>HOME PAGE</h1>
    <button id="enter-code">Enter Transmission Code</button>
  </div>

  <!-- GALLERY PAGE -->
  <div id="gallery-page">
    <audio id="my-audio" src="assets/NMTAH_Side_A.m4a" controls></audio>

    <div id="media-control-hub">
      <button id="play-pause">Connect</button>
      <button id="rewind-btn">Rewind -10s</button>
      <div id="timerDisplay">00:00</div>

      <div id="settings-section">
        <button id="settings-btn">Cog</button>
        <div id="settings-dropdown">
          <button>Option 1</button>
          <button>Option 2</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const home = document.getElementById('home-page');
    const gallery = document.getElementById('gallery-page');
    const enterCode = document.getElementById('enter-code');
    const playPauseBtn = document.getElementById('play-pause');
    const timerDisplay = document.getElementById('timerDisplay');
    const rewindBtn = document.getElementById('rewind-btn');

    const settingsBtn = document.getElementById('settings-btn');
    const settingsDropdown = document.getElementById('settings-dropdown');

    const audio = document.getElementById('my-audio');

    // Switch to gallery
    enterCode.addEventListener('click', () => {
      console.log("Enter code clicked. Switch page.");
      home.classList.remove('active');
      gallery.classList.add('active');
    });

    // Play/pause
    playPauseBtn.addEventListener('click', () => {
      console.log("Play/pause clicked, paused =", audio.paused);
      if (audio.paused) {
        audio.play().then(() => {
          console.log("audio.play() resolved, currentTime =", audio.currentTime);
          playPauseBtn.textContent = "Connected...";
        }).catch(err => {
          console.warn("audio.play() failed:", err);
        });
      } else {
        audio.pause();
        console.log("audio.pause() called, currentTime =", audio.currentTime);
        playPauseBtn.textContent = "Connect";
      }
    });

    // Rewind
    rewindBtn.addEventListener('click', () => {
      audio.currentTime = Math.max(0, audio.currentTime - 10);
      console.log("Rewind, currentTime now =", audio.currentTime);
      updateTimer();
    });

    function updateTimer() {
      let t = audio.currentTime;
      let m = Math.floor(t/60);
      let s = Math.floor(t%60);
      if (s<10) s="0"+s;
      timerDisplay.textContent = `${m}:${s}`;
    }
    setInterval(updateTimer, 500);

    // Cog
    settingsBtn.addEventListener('click', () => {
      console.log("Cog clicked!");
      if (settingsDropdown.style.display === "block") {
        settingsDropdown.style.display = "none";
      } else {
        settingsDropdown.style.display = "block";
      }
    });
  </script>
</body>
</html>
